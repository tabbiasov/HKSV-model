tabbiasov$ ifort -c -O3 -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 -qopenmp nrtype.f90 nr.f90 nrutil.f90 locate.f90 tridag.f90
tabbiasov$ ifort -c -O3 -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 -qopenmp code.f90
tabbiasov$ ifort -O3 -qopenmp -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 nrtype.o nr.o nrutil.o locate.o tridag.o code.o 
tabbiasov$ ./a.out
 -0.112068014576607       0.112068014576607     
 numiter   1.00000000000000     
  0.879299998283386       7.366000115871429E-002  0.916100025177002     
   4.13000011444092     
  0.947000026702881       2.801700364415172E-002  1.799999922513962E-002
 check2           1  0.890394568443298     
 check2           1  0.999992847442627     
 check2           1   1.00000000000000     
 check2           1   1.00000000000000     
 check2           1   1.00000000000000     
 check2           2  4.258104786276817E-002
 check2           2  0.917964816093445     
 check2           2  0.999996662139893     
 check2           2   1.00000000000000     
 check2           2   1.00000000000000     
 check2           3  1.509662865828432E-006
 check2           3  5.979458987712860E-002
 check2           3  0.940205395221710     
 check2           3  0.999998509883881     
 check2           3   1.00000000000000     
 check2           4  1.293054239257050E-014
 check2           4  3.326285195726086E-006
 check2           4  8.203521370887756E-002
 check2           4  0.957418978214264     
 check2           4   1.00000000000000     
 check2           5  2.152789392545288E-026
 check2           5  4.578574254758203E-014
 check2           5  7.139619356166804E-006
 check2           5  0.109605409204960     
 check2           5   1.00000000000000     
 income
   764.026644829751        798.955395308206        835.915211818513     
   875.025392627003        916.412404366190     
  3.112375000000000E-002
          60
          59
          58
          57
          56
          55
          54
          53
          52
          51
          50
          49
          48
          47
          46
          45
          44
          43
          42
          41
          40
          39
          38
          37
          36
          35
          34
          33
          32
          31
          30
          29
          28
          27
          26
          25
          24
          23
          22
          21
          20
          19
          18
          17
          16
          15
          14
          13
          12
          11
          10
           9
           8
           7
           6
           5
           4
           3
           2
           1
 one
   10000000000.0000        7.07633811054686        6.06729651215627     
 two
   9.13942898388207        8.55863434734890        6.42733720563912     
 three
   10000000000.0000        7.25165283020943        6.15846707815365     
 four
   9.15549353809954        8.68642548235058        6.54251238175809     
   583.343450000000     
          50          36          13           5
      117000
 cumprobs:
  1.509662865828432E-006
  5.979458987712860E-002
  0.940205395221710     
  0.999998509883881     
   1.00000000000000     
  1.490116119384766E-006
  5.979311466217041E-002
  0.880410805344582     
  5.979308021426277E-002
 Ex ante welfare  -16.6517454686340     
 Ex ante welfare by state
  -17.8933358425445       -119527.483428197        6680.00000000000     
  -17.2857091471248       -417795.590086007        24170.0000000000     
  -16.6394395062302       -637273.893649109        38299.0000000000     
  -16.0182399200657       -387160.858867989        24170.0000000000     
  -15.4792277851203       -103416.720832389        6681.00000000000     
 start
 frac increase balance with fixed rate  1.279657142857143E-002
 end
 welfare overall:  -11.9213135546592     
 housing stock   1.55376929912556     
 rental stock  0.309413672585137     
 total residential investment  6.012207944282594E-002
 total non dur consumption  0.907913510414605     
 H/(H+W)  0.208148853231108        1.04074425064523       0.567907270811027     
 wealth over income   1.22951500051649     
 liquid wealth net of debt over income -5.009566735358795E-002
 liquid wealth net of debt over income: working age -0.312819876079258     
 liquid wealth net of debt over income: retired   1.15402476253409     
 C / I_d   15.1011661410201     
 fracown  0.720266441901093     
  0.916100025177002       7.366000115871429E-002  0.879299998283386     
   4.13000011444092     
 diff  8.432929371915258E-003  1.842951210016797E-003  3.646871181664702E-006
  4.518215992215144E-005  8.432929371915258E-003
 ex post welfare by state:
  -13.4116853513324        305283.000000000     
  -13.1095295559546        848599.000000000     
  -12.7043838636369        1199543.00000000     
  -12.2238708690391        841514.000000000     
  -11.7398098645152        305061.000000000     
 ex post welfare weighted by states:
  -12.6647041575058     
 consumption by states:
  0.982371870200974        1.46078264488599     
   1.01477076763767        1.45580491599289     
   1.05910076002687        1.48726168695172     
   1.11610433267781        1.55033324612617     
   1.18315015777346        1.63263591236052     
 solving with variable r
 extra phis  1.782848357782374E-002  3.562141681417476E-002
 new phis
  1.782848357782374E-002  3.562141681417476E-002  0.540962765872877     
   585.462168750000     
          60
          59
          58
          57
          56
          55
          54
          53
          52
          51
          50
          49
          48
          47
          46
          45
          44
          43
          42
          41
          40
          39
          38
          37
          36
          35
          34
          33
          32
          31
          30
          29
          28
          27
          26
          25
          24
          23
          22
          21
          20
          19
          18
          17
          16
          15
          14
          13
          12
          11
          10
           9
           8
           7
           6
           5
           4
           3
           2
           1
 one
   10000000000.0000        7.08122970032592        6.06977697625997     
 two
   9.15797236586950        8.57255253023452        6.43045457384196     
 three
   10000000000.0000        7.25659428588688        6.16065475297813     
 four
   9.17401692670356        8.70098794325455        6.54545308765325     
   587.447340500000     
 cumprobs:
  1.509662865828432E-006
  5.979458987712860E-002
  0.940205395221710     
  0.999998509883881     
   1.00000000000000     
  1.490116119384766E-006
  5.979311466217041E-002
  0.880410805344582     
  5.979308021426277E-002
 Ex ante welfare  -16.6502020046240     
 Ex ante welfare by state
  -17.9126767431010       -119656.680643914        6680.00000000000     
  -17.2948234976581       -418015.883938397        24170.0000000000     
  -16.6376293645031       -637204.567031104        38299.0000000000     
  -16.0060190075658       -386865.479412864        24170.0000000000     
  -15.4584028493008       -103277.589436179        6681.00000000000     
 start
 frac increase balance with fixed rate  1.511885714285714E-002
 end
 welfare overall:  -11.9228409263287     
 housing stock   1.55109423077243     
 rental stock  0.312972878806886     
 total residential investment  6.019722234420151E-002
 total non dur consumption  0.907794510530264     
 H/(H+W)  0.208277812641353        1.04138904768639       0.568099211754238     
 wealth over income   1.22747877363417     
 liquid wealth net of debt over income -5.080417749669154E-002
 liquid wealth net of debt over income: working age -0.314008719294576     
 liquid wealth net of debt over income: retired   1.15559630603750     
 C / I_d   15.0803388457801     
 fracown  0.717692172123031     
  0.916100025177002       7.366000115871429E-002  0.879299998283386     
   4.13000011444092     
 diff  8.162427948867434E-003  1.548355869186620E-003  2.505556371149117E-004
  2.853302285623942E-005  8.162427948867434E-003
 ex post welfare by state:
  -13.4403506036170        305283.000000000     
  -13.1240568482574        848599.000000000     
  -12.7040652510201        1199543.00000000     
  -12.2119696399801        841514.000000000     
  -11.7171665785368        305061.000000000     
 ex post welfare weighted by states:
  -12.6657824535246     
 consumption by states:
  0.979331946537272        1.37242967565158     
   1.01337328622519        1.40726995224201     
   1.05910036142846        1.48904904640152     
   1.11778295806775        1.58974447363259     
   1.18698606469542        1.71639727678939     
 Percentage increase in welfare constant r over variable r
  8.514182450163051E-005  -12.6647041575058     
 by state:
           1  2.137334088422846E-003  -13.4116853513324     
           2  1.108147492310385E-003  -13.1095295559546     
           3 -2.507895071638762E-005  -12.7043838636369     
           4 -9.736055940512089E-004  -12.2238708690391     
           5 -1.928760877710283E-003  -11.7398098645152     
 by state CE: 
           1
           2
           3
           4
           5
 CE state:           1   1.02260002861023     
 CE young state:           1   1.01760002861023     
 CE middle state:           1   1.02500002861023     
 CE old state:           1   1.00560002861023     
 CE low income state:           1   1.01460002861023     
 CE middle income state:           1   1.02640002861023     
 CE high income state:           1   1.02180002861023     
 CE state:           2   1.01180002861023     
 CE young state:           2   1.01020002861023     
 CE middle state:           2   1.01260002861023     
 CE old state:           2   1.00180002861023     
 CE low income state:           2   1.00760002861023     
 CE middle income state:           2   1.01360002861023     
 CE high income state:           2   1.01220002861023     
 CE state:           3  0.999800028610230     
 CE young state:           3  0.999200028610229     
 CE middle state:           3   1.00000002861023     
 CE old state:           3   1.00020002861023     
 CE low income state:           3  0.999400028610229     
 CE middle income state:           3  0.999800028610230     
 CE high income state:           3   1.00040002861023     
 CE state:           4  0.989600028610229     
 CE young state:           4  0.991000028610230     
 CE middle state:           4  0.988600028610229     
 CE old state:           4   1.00120002861023     
 CE low income state:           4  0.991800028610230     
 CE middle income state:           4  0.988400028610229     
 CE high income state:           4  0.990800028610230     
 CE state:           5  0.978800028610230     
 CE young state:           5  0.980200028610229     
 CE middle state:           5  0.978200028610229     
 CE old state:           5   1.00260002861023     
 CE low income state:           5  0.982600028610229     
 CE middle income state:           5  0.976800028610230     
 CE high income state:           5  0.984000028610230     
 CE overall   1.00100002861023     
 CE overall young   1.00040002861023     
 CE overall middle   1.00120002861023     
 CE overall old   1.00160002861023     
tabbiasov$ ifort -c -O3 -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 -qopenmp nrtype.f90 nr.f90 nrutil.f90 locate.f90 tridag.f90
tabbiasov$ ifort -c -O3 -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 -qopenmp code.f90
tabbiasov$ ifort -O3 -qopenmp -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 nrtype.o nr.o nrutil.o locate.o tridag.o code.o 
tabbiasov$ ./a.out
 -0.112068014576607       0.112068014576607     
 numiter   1.00000000000000     
  0.879299998283386       7.366000115871429E-002  0.916100025177002     
   4.13000011444092     
  0.947000026702881       2.801700364415172E-002  1.799999922513962E-002
 check2           1  0.890394568443298     
 check2           1  0.999992847442627     
 check2           1   1.00000000000000     
 check2           1   1.00000000000000     
 check2           1   1.00000000000000     
 check2           2  4.258104786276817E-002
 check2           2  0.917964816093445     
 check2           2  0.999996662139893     
 check2           2   1.00000000000000     
 check2           2   1.00000000000000     
 check2           3  1.509662865828432E-006
 check2           3  5.979458987712860E-002
 check2           3  0.940205395221710     
 check2           3  0.999998509883881     
 check2           3   1.00000000000000     
 check2           4  1.293054239257050E-014
 check2           4  3.326285195726086E-006
 check2           4  8.203521370887756E-002
 check2           4  0.957418978214264     
 check2           4   1.00000000000000     
 check2           5  2.152789392545288E-026
 check2           5  4.578574254758203E-014
 check2           5  7.139619356166804E-006
 check2           5  0.109605409204960     
 check2           5   1.00000000000000     
 income
   764.026644829751        798.955395308206        835.915211818513     
   875.025392627003        916.412404366190     
  2.733487500000000E-002
          60
          59
          58
          57
          56
          55
          54
          53
          52
          51
          50
          49
          48
          47
          46
          45
          44
          43
          42
          41
          40
          39
          38
          37
          36
          35
          34
          33
          32
          31
          30
          29
          28
          27
          26
          25
          24
          23
          22
          21
          20
          19
          18
          17
          16
          15
          14
          13
          12
          11
          10
           9
           8
           7
           6
           5
           4
           3
           2
           1
 one
   10000000000.0000        7.10267826414369        6.09008873024984     
 two
   9.17893430086605        8.59150716273854        6.45258098334631     
 three
   10000000000.0000        7.28457521789703        6.18567012714572     
 four
   9.19557784266675        8.72486933295231        6.57180871097090     
   591.301843125000     
          50          36          13           5
      117000
 cumprobs:
  1.509662865828432E-006
  5.979458987712860E-002
  0.940205395221710     
  0.999998509883881     
   1.00000000000000     
  1.490116119384766E-006
  5.979311466217041E-002
  0.880410805344582     
  5.979308021426277E-002
 Ex ante welfare  -16.6678761827737     
 Ex ante welfare by state
  -17.9765789431048       -120083.547339940        6680.00000000000     
  -17.3347049045106       -418979.817542020        24170.0000000000     
  -16.6542953935786       -637842.859278668        38299.0000000000     
  -16.0018866651097       -386765.600695700        24170.0000000000     
  -15.4341855142107       -103115.793420442        6681.00000000000     
 start
 frac increase balance with fixed rate  1.292600000000000E-002
 end
 welfare overall:  -11.9132734773973     
 housing stock   1.57299274029472     
 rental stock  0.291324626581475     
 total residential investment  5.990901488339292E-002
 total non dur consumption  0.909047434498870     
 H/(H+W)  0.208651188006173        1.04325592448456       0.568654328499944     
 wealth over income   1.24071627756281     
 liquid wealth net of debt over income -5.366832960878761E-002
 liquid wealth net of debt over income: working age -0.313416062209080     
 liquid wealth net of debt over income: retired   1.13681028276553     
 C / I_d   15.1738004082198     
 fracown  0.733744109204203     
  0.916100025177002       7.366000115871429E-002  0.879299998283386     
   4.13000011444092     
 diff  1.174283241430436E-002  3.778407058422565E-003  4.671973484420739E-003
  1.327122936533744E-004  1.174283241430436E-002
 ex post welfare by state:
  -13.4625269518860        305283.000000000     
  -13.1322304598569        848599.000000000     
  -12.6991955974551        1199543.00000000     
  -12.1946555561872        841514.000000000     
  -11.6889794226552        305061.000000000     
 ex post welfare weighted by states:
  -12.6614098752510     
 consumption by states:
  0.980103765025257        1.40043122216032     
   1.01388305651709        1.42621683047914     
   1.05978166719790        1.49834905924791     
   1.11857132842295        1.60231969276773     
   1.18762635425694        1.73357678594324     
 solving with variable r
 extra phis  1.782848357782374E-002  3.562141681417476E-002
 new phis
  1.782848357782374E-002  3.562141681417476E-002  0.540962765872877     
   593.919113250000     
          60
          59
          58
          57
          56
          55
          54
          53
          52
          51
          50
          49
          48
          47
          46
          45
          44
          43
          42
          41
          40
          39
          38
          37
          36
          35
          34
          33
          32
          31
          30
          29
          28
          27
          26
          25
          24
          23
          22
          21
          20
          19
          18
          17
          16
          15
          14
          13
          12
          11
          10
           9
           8
           7
           6
           5
           4
           3
           2
           1
 one
   10000000000.0000        7.10758043013007        6.09255257091559     
 two
   9.19709518442542        8.60535407717660        6.45565715709771     
 three
   10000000000.0000        7.28946154010234        6.18787355531613     
 four
   9.21374212608534        8.73920202192066        6.57476594225967     
   594.022723125000     
 cumprobs:
  1.509662865828432E-006
  5.979458987712860E-002
  0.940205395221710     
  0.999998509883881     
   1.00000000000000     
  1.490116119384766E-006
  5.979311466217041E-002
  0.880410805344582     
  5.979308021426277E-002
 Ex ante welfare  -16.6664992707419     
 Ex ante welfare by state
  -17.9960313834303       -120213.489641314        6680.00000000000     
  -17.3439767891584       -419203.918993959        24170.0000000000     
  -16.6526530185104       -637779.957955931        38299.0000000000     
  -15.9898428082817       -386474.500676168        24170.0000000000     
  -15.4135697958884       -102978.059806330        6681.00000000000     
 start
 frac increase balance with fixed rate  1.571428571428572E-002
 end
 welfare overall:  -11.9152275804557     
 housing stock   1.57166326361052     
 rental stock  0.293517109313069     
 total residential investment  5.996485438383818E-002
 total non dur consumption  0.908856959563020     
 H/(H+W)  0.208867292927881        1.04433644907622       0.568975210276679     
 wealth over income   1.23884412692264     
 liquid wealth net of debt over income -5.492594954677049E-002
 liquid wealth net of debt over income: working age -0.316426352678289     
 liquid wealth net of debt over income: retired   1.14366359844226     
 C / I_d   15.1564940646794     
 fracown  0.730979883456094     
  0.916100025177002       7.366000115871429E-002  0.879299998283386     
   4.13000011444092     
 diff  1.034747974805133E-002  3.328637563049905E-003  8.043121699605730E-003
  1.077213605893950E-004  1.034747974805133E-002
 ex post welfare by state:
  -13.4898450584899        305283.000000000     
  -13.1454436295868        848599.000000000     
  -12.6989343000886        1199543.00000000     
  -12.1817259289048        841514.000000000     
  -11.6655442566796        305061.000000000     
 ex post welfare weighted by states:
  -12.6617554127341     
 consumption by states:
  0.977201425607440        1.32140713144258     
   1.01245983518354        1.39208807468762     
   1.05978376174626        1.50138818972004     
   1.12042711613134        1.64285928521469     
   1.19128237138445        1.81014819562098     
 Percentage increase in welfare constant r over variable r
  2.729060084444998E-005  -12.6614098752510     
 by state:
           1  2.029196056695044E-003  -13.4625269518860     
           2  1.006163406158891E-003  -13.1322304598569     
           3 -2.057589903822844E-005  -12.6991955974551     
           4 -1.060269986531054E-003  -12.1946555561872     
           5 -2.004894108220922E-003  -11.6889794226552     
 by state CE: 
           1
           2
           3
           4
           5
 CE state:           1   1.02160002861023     
 CE young state:           1   1.01580002861023     
 CE middle state:           1   1.02440002861023     
 CE old state:           1   1.00820002861023     
 CE low income state:           1   1.01360002861023     
 CE middle income state:           1   1.02520002861023     
 CE high income state:           1   1.02080002861023     
 CE state:           2   1.01060002861023     
 CE young state:           2   1.00760002861023     
 CE middle state:           2   1.01240002861023     
 CE old state:           2   1.00480002861023     
 CE low income state:           2   1.00680002861023     
 CE middle income state:           2   1.01240002861023     
 CE high income state:           2   1.01060002861023     
 CE state:           3  0.999800028610230     
 CE young state:           3  0.999200028610229     
 CE middle state:           3   1.00020002861023     
 CE old state:           3   1.00160002861023     
 CE low income state:           3  0.999600028610229     
 CE middle income state:           3  0.999800028610230     
 CE high income state:           3   1.00060002861023     
 CE state:           4  0.988600028610229     
 CE young state:           4  0.989000028610230     
 CE middle state:           4  0.988400028610229     
 CE old state:           4   1.00220002861023     
 CE low income state:           4  0.990600028610229     
 CE middle income state:           4  0.987400028610229     
 CE high income state:           4  0.991200028610229     
 CE state:           5  0.978000028610229     
 CE young state:           5  0.979800028610230     
 CE middle state:           5  0.977200028610229     
 CE old state:           5   1.00480002861023     
 CE low income state:           5  0.980600028610230     
 CE middle income state:           5  0.976400028610229     
 CE high income state:           5  0.984000028610230     
 CE overall   1.00020002861023     
 CE overall young  0.999000028610230     
 CE overall middle   1.00100002861023     
 CE overall old   1.00340002861023     
tabbiasov$ ifort -c -O3 -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 -qopenmp nrtype.f90 nr.f90 nrutil.f90 locate.f90 tridag.f90
tabbiasov$ ifort -c -O3 -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 -qopenmp code.f90
tabbiasov$ ifort -O3 -qopenmp -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 nrtype.o nr.o nrutil.o locate.o tridag.o code.o 
tabbiasov$ ./a.out
 -0.112068014576607       0.112068014576607     
 numiter   1.00000000000000     
  0.879299998283386       7.366000115871429E-002  0.916100025177002     
   4.13000011444092     
  0.947000026702881       2.801700364415172E-002  1.799999922513962E-002
 check2           1  0.890394568443298     
 check2           1  0.999992847442627     
 check2           1   1.00000000000000     
 check2           1   1.00000000000000     
 check2           1   1.00000000000000     
 check2           2  4.258104786276817E-002
 check2           2  0.917964816093445     
 check2           2  0.999996662139893     
 check2           2   1.00000000000000     
 check2           2   1.00000000000000     
 check2           3  1.509662865828432E-006
 check2           3  5.979458987712860E-002
 check2           3  0.940205395221710     
 check2           3  0.999998509883881     
 check2           3   1.00000000000000     
 check2           4  1.293054239257050E-014
 check2           4  3.326285195726086E-006
 check2           4  8.203521370887756E-002
 check2           4  0.957418978214264     
 check2           4   1.00000000000000     
 check2           5  2.152789392545288E-026
 check2           5  4.578574254758203E-014
 check2           5  7.139619356166804E-006
 check2           5  0.109605409204960     
 check2           5   1.00000000000000     
 income
   764.026644829751        798.955395308206        835.915211818513     
   875.025392627003        916.412404366190     
  2.851762500000000E-002
          60
          59
          58
          57
          56
          55
          54
          53
          52
          51
          50
          49
          48
          47
          46
          45
          44
          43
          42
          41
          40
          39
          38
          37
          36
          35
          34
          33
          32
          31
          30
          29
          28
          27
          26
          25
          24
          23
          22
          21
          20
          19
          18
          17
          16
          15
          14
          13
          12
          11
          10
           9
           8
           7
           6
           5
           4
           3
           2
           1
 one
   10000000000.0000        7.11555733058858        6.10148734205277     
 two
   9.19819865093656        8.60781350588162        6.46518806260022     
 three
   10000000000.0000        7.30094807944059        6.19911662849288     
 four
   9.21516156021046        8.74397962538347        6.58634053438755     
   581.395081375000     
          50          36          13           5
      117000
 cumprobs:
  1.509662865828432E-006
  5.979458987712860E-002
  0.940205395221710     
  0.999998509883881     
   1.00000000000000     
  1.490116119384766E-006
  5.979311466217041E-002
  0.880410805344582     
  5.979308021426277E-002
 Ex ante welfare  -16.6753365699110     
 Ex ante welfare by state
  -18.0178096835579       -120358.968686167        6680.00000000000     
  -17.3587032613909       -419559.857827819        24170.0000000000     
  -16.6611155710784       -638104.065256732        38299.0000000000     
  -15.9929987382204       -386550.779502786        24170.0000000000     
  -15.4108644991738       -102959.985718980        6681.00000000000     
 start
 frac increase balance with fixed rate  1.297485714285714E-002
 end
 welfare overall:  -11.9073857545152     
 housing stock   1.58352002704768     
 rental stock  0.283693394776971     
 total residential investment  5.989165388439519E-002
 total non dur consumption  0.909706482421957     
 H/(H+W)  0.208985439910844        1.04492718398257       0.569150512186273     
 wealth over income   1.24614866046191     
 liquid wealth net of debt over income -5.598595013854183E-002
 liquid wealth net of debt over income: working age -0.312581400035558     
 liquid wealth net of debt over income: retired   1.12004508611725     
 C / I_d   15.1892028925038     
 fracown  0.741059950555081     
  0.916100025177002       7.366000115871429E-002  0.879299998283386     
   4.13000011444092     
 diff  1.561367853001554E-002  5.096522508062521E-003  1.143162516348127E-002
  1.571171578725605E-004  1.561367853001554E-002
 ex post welfare by state:
  -13.4864439525344        305283.000000000     
  -13.1426376284883        848599.000000000     
  -12.6970516158293        1199543.00000000     
  -12.1800831770596        841514.000000000     
  -11.6627041339776        305061.000000000     
 ex post welfare weighted by states:
  -12.6594906585546     
 consumption by states:
  0.979067064179323        1.36999063640130     
   1.01345571963314        1.41576246782493     
   1.06030881454148        1.49727697368904     
   1.12006722114431        1.62135010569679     
   1.18999303502644        1.78449811724390     
 solving with variable r
 extra phis  1.782848357782374E-002  3.562141681417476E-002
 new phis
  1.782848357782374E-002  3.562141681417476E-002  0.540962765872877     
   583.699551375000     
          60
          59
          58
          57
          56
          55
          54
          53
          52
          51
          50
          49
          48
          47
          46
          45
          44
          43
          42
          41
          40
          39
          38
          37
          36
          35
          34
          33
          32
          31
          30
          29
          28
          27
          26
          25
          24
          23
          22
          21
          20
          19
          18
          17
          16
          15
          14
          13
          12
          11
          10
           9
           8
           7
           6
           5
           4
           3
           2
           1
 one
   10000000000.0000        7.12042836296324        6.10394083112125     
 two
   9.21623159092978        8.62161346577330        6.46826146136454     
 three
   10000000000.0000        7.30578907718089        6.20134343543346     
 four
   9.23322652328910        8.75831599827126        6.58930046031832     
   590.459344000000     
 cumprobs:
  1.509662865828432E-006
  5.979458987712860E-002
  0.940205395221710     
  0.999998509883881     
   1.00000000000000     
  1.490116119384766E-006
  5.979311466217041E-002
  0.880410805344582     
  5.979308021426277E-002
 Ex ante welfare  -16.6740666468426     
 Ex ante welfare by state
  -18.0373334308953       -120489.387318380        6680.00000000000     
  -17.3680813591336       -419786.526450259        24170.0000000000     
  -16.6595901431824       -638045.642893744        38299.0000000000     
  -15.9810726484496       -386262.525913028        24170.0000000000     
  -15.3902981753450       -102822.582109480        6681.00000000000     
 start
 frac increase balance with fixed rate  1.573000000000000E-002
 end
 welfare overall:  -11.9079212288128     
 housing stock   1.58655127617733     
 rental stock  0.281767351079467     
 total residential investment  5.989850028488529E-002
 total non dur consumption  0.909758250440495     
 H/(H+W)  0.209534264098182        1.04767130487824       0.569963654306657     
 wealth over income   1.24545160475704     
 liquid wealth net of debt over income -5.937230316177112E-002
 liquid wealth net of debt over income: working age -0.317483911997814     
 liquid wealth net of debt over income: retired   1.12368467442110     
 C / I_d   15.1883310284721     
 fracown  0.741536437538306     
  0.916100025177002       7.366000115871429E-002  0.879299998283386     
   4.13000011444092     
 diff  2.491866631115125E-002  5.188710811848793E-003  2.491866631115125E-002
  1.556814288221312E-004  1.471635969334787E-002
 ex post welfare by state:
  -13.5131380801022        305283.000000000     
  -13.1552118907540        848599.000000000     
  -12.6957108235591        1199543.00000000     
  -12.1652926931180        841514.000000000     
  -11.6386874192506        305061.000000000     
 ex post welfare weighted by states:
  -12.6587587926785     
 consumption by states:
  0.976196289030264        1.29093727190566     
   1.01211673530579        1.38268802087549     
   1.06055717025894        1.50326859321057     
   1.12204709080763        1.67421541345755     
   1.19387461246408        1.85766322889749     
 Percentage increase in welfare constant r over variable r
 -5.781163680559580E-005  -12.6594906585546     
 by state:
           1  1.979330330648317E-003  -13.4864439525344     
           2  9.567533261762248E-004  -13.1426376284883     
           3 -1.055987098980134E-004  -12.6970516158293     
           4 -1.214317154212483E-003  -12.1800831770596     
           5 -2.059274971836220E-003  -11.6627041339776     
 by state CE: 
           1
           2
           3
           4
           5
 CE state:           1   1.02100002861023     
 CE young state:           1   1.01620002861023     
 CE middle state:           1   1.02340002861023     
 CE old state:           1   1.00540002861023     
 CE low income state:           1   1.01280002861023     
 CE middle income state:           1   1.02480002861023     
 CE high income state:           1   1.02040002861023     
 CE state:           2   1.01020002861023     
 CE young state:           2   1.00840002861023     
 CE middle state:           2   1.01120002861023     
 CE old state:           2   1.00280002861023     
 CE low income state:           2   1.00620002861023     
 CE middle income state:           2   1.01180002861023     
 CE high income state:           2   1.01020002861023     
 CE state:           3  0.998800028610230     
 CE young state:           3  0.998600028610229     
 CE middle state:           3  0.999000028610230     
 CE old state:           3   1.00060002861023     
 CE low income state:           3  0.999000028610230     
 CE middle income state:           3  0.998800028610230     
 CE high income state:           3  0.999600028610229     
 CE state:           4  0.987000028610230     
 CE young state:           4  0.986800028610230     
 CE middle state:           4  0.987000028610230     
 CE old state:           4   1.00120002861023     
 CE low income state:           4  0.989800028610230     
 CE middle income state:           4  0.985400028610229     
 CE high income state:           4  0.989400028610229     
 CE state:           5  0.977400028610229     
 CE young state:           5  0.978800028610230     
 CE middle state:           5  0.976800028610230     
 CE old state:           5   1.00340002861023     
 CE low income state:           5  0.981000028610230     
 CE middle income state:           5  0.975400028610229     
 CE high income state:           5  0.983200028610229     
 CE overall  0.999400028610229     
 CE overall young  0.998400028610229     
 CE overall middle   1.00000002861023     
 CE overall old   1.00200002861023     
tabbiasov$ ifort -c -O3 -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 -qopenmp nrtype.f90 nr.f90 nrutil.f90 locate.f90 tridag.f90
tabbiasov$ ifort -c -O3 -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 -qopenmp code.f90
tabbiasov$ ifort -O3 -qopenmp -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 nrtype.o nr.o nrutil.o locate.o tridag.o code.o 
tabbiasov$ ./a.out
 -0.112068014576607       0.112068014576607     
 numiter   1.00000000000000     
  0.879299998283386       7.366000115871429E-002  0.916100025177002     
   4.13000011444092     
  0.947000026702881       2.801700364415172E-002  1.799999922513962E-002
 check2           1  0.890394568443298     
 check2           1  0.999992847442627     
 check2           1   1.00000000000000     
 check2           1   1.00000000000000     
 check2           1   1.00000000000000     
 check2           2  4.258104786276817E-002
 check2           2  0.917964816093445     
 check2           2  0.999996662139893     
 check2           2   1.00000000000000     
 check2           2   1.00000000000000     
 check2           3  1.509662865828432E-006
 check2           3  5.979458987712860E-002
 check2           3  0.940205395221710     
 check2           3  0.999998509883881     
 check2           3   1.00000000000000     
 check2           4  1.293054239257050E-014
 check2           4  3.326285195726086E-006
 check2           4  8.203521370887756E-002
 check2           4  0.957418978214264     
 check2           4   1.00000000000000     
 check2           5  2.152789392545288E-026
 check2           5  4.578574254758203E-014
 check2           5  7.139619356166804E-006
 check2           5  0.109605409204960     
 check2           5   1.00000000000000     
 income
   764.026644829751        798.955395308206        835.915211818513     
   875.025392627003        916.412404366190     
  2.568587500000000E-002
          60
          59
          58
          57
          56
          55
          54
          53
          52
          51
          50
          49
          48
          47
          46
          45
          44
          43
          42
          41
          40
          39
          38
          37
          36
          35
          34
          33
          32
          31
          30
          29
          28
          27
          26
          25
          24
          23
          22
          21
          20
          19
          18
          17
          16
          15
          14
          13
          12
          11
          10
           9
           8
           7
           6
           5
           4
           3
           2
           1
 one
   10000000000.0000        7.07633811054686        6.06729651215627     
 two
   9.13942898388207        8.55863434734890        6.42733720563912     
 three
   10000000000.0000        7.25165283020943        6.15846707815365     
 four
   9.15549353809954        8.68642548235058        6.54251238175809     
   583.006208375000     
          50          36          13           5
      117000
 cumprobs:
  1.509662865828432E-006
  5.979458987712860E-002
  0.940205395221710     
  0.999998509883881     
   1.00000000000000     
  1.490116119384766E-006
  5.979311466217041E-002
  0.880410805344582     
  5.979308021426277E-002
 Ex ante welfare  -16.6517454686340     
 Ex ante welfare by state
  -17.8933358425445       -119527.483428197        6680.00000000000     
  -17.2857091471248       -417795.590086007        24170.0000000000     
  -16.6394395062302       -637273.893649109        38299.0000000000     
  -16.0182399200657       -387160.858867989        24170.0000000000     
  -15.4792277851203       -103416.720832389        6681.00000000000     
 start
 frac increase balance with fixed rate  1.279657142857143E-002
 end
 welfare overall:  -11.9213135546592     
 housing stock   1.55376929912556     
 rental stock  0.309413672585137     
 total residential investment  6.012207944282594E-002
 total non dur consumption  0.907913510414605     
 H/(H+W)  0.208148853231108        1.04074425064523       0.567907270811027     
 wealth over income   1.22951500051649     
 liquid wealth net of debt over income -5.009566735358795E-002
 liquid wealth net of debt over income: working age -0.312819876079258     
 liquid wealth net of debt over income: retired   1.15402476253409     
 C / I_d   15.1011661410201     
 fracown  0.720266441901093     
  0.916100025177002       7.366000115871429E-002  0.879299998283386     
   4.13000011444092     
 diff  8.432929371915258E-003  1.842951210016797E-003  3.646871181664702E-006
  4.518215992215144E-005  8.432929371915258E-003
 ex post welfare by state:
  -13.4116853513324        305283.000000000     
  -13.1095295559546        848599.000000000     
  -12.7043838636369        1199543.00000000     
  -12.2238708690391        841514.000000000     
  -11.7398098645152        305061.000000000     
 ex post welfare weighted by states:
  -12.6647041575058     
 consumption by states:
  0.982371870200974        1.46078264488599     
   1.01477076763767        1.45580491599289     
   1.05910076002687        1.48726168695172     
   1.11610433267781        1.55033324612617     
   1.18315015777346        1.63263591236052     
 solving with variable r
 extra phis  8.923148154748507E-006  8.923148154748507E-006
 new phis
  8.923148154748507E-006  8.923148154748507E-006  0.540962765872877     
   585.044809875000     
          60
          59
          58
          57
          56
          55
          54
          53
          52
          51
          50
          49
          48
          47
          46
          45
          44
          43
          42
          41
          40
          39
          38
          37
          36
          35
          34
          33
          32
          31
          30
          29
          28
          27
          26
          25
          24
          23
          22
          21
          20
          19
          18
          17
          16
          15
          14
          13
          12
          11
          10
           9
           8
           7
           6
           5
           4
           3
           2
           1
 one
   10000000000.0000        7.07795781844627        6.06779329387187     
 two
   9.15143564250275        8.56685490505055        6.42811431689249     
 three
   10000000000.0000        7.25368399403426        6.15902864793043     
 four
   9.16749509244457        8.69553527896997        6.54341519033201     
   589.337276000000     
 cumprobs:
  1.509662865828432E-006
  5.979458987712860E-002
  0.940205395221710     
  0.999998509883881     
   1.00000000000000     
  1.490116119384766E-006
  5.979311466217041E-002
  0.880410805344582     
  5.979308021426277E-002
 Ex ante welfare  -16.6511157484824     
 Ex ante welfare by state
  -17.8964075233443       -119548.002255940        6680.00000000000     
  -17.2871868557327       -417831.306303061        24170.0000000000     
  -16.6388887249006       -637252.799274968        38299.0000000000     
  -16.0154943418162       -387094.498241697        24170.0000000000     
  -15.4744751943004       -103384.968773121        6681.00000000000     
 start
 frac increase balance with fixed rate  1.525971428571429E-002
 end
 welfare overall:  -11.9221750356646     
 housing stock   1.55139094620078     
 rental stock  0.312262925533311     
 total residential investment  6.017512724560906E-002
 total non dur consumption  0.907805628414230     
 H/(H+W)  0.208189717716508        1.04094857307013       0.567968104494732     
 wealth over income   1.22815696076879     
 liquid wealth net of debt over income -5.029127505023633E-002
 liquid wealth net of debt over income: working age -0.313397210187603     
 liquid wealth net of debt over income: retired   1.15557872640978     
 C / I_d   15.0860608022236     
 fracown  0.718103085779306     
  0.916100025177002       7.366000115871429E-002  0.879299998283386     
   4.13000011444092     
 diff  8.165425413727220E-003  1.593729205495657E-003  3.354432496006359E-005
  3.272973453462164E-005  8.165425413727220E-003
 ex post welfare by state:
  -13.4289818512461        305283.000000000     
  -13.1181097966329        848599.000000000     
  -12.7039003668832        1199543.00000000     
  -12.2167177964178        841514.000000000     
  -11.7262865248969        305061.000000000     
 ex post welfare weighted by states:
  -12.6652289236873     
 consumption by states:
  0.980750606642200        1.36839265382577     
   1.01406660992067        1.40539822645312     
   1.05912260315529        1.48833600316389     
   1.11699988389685        1.59268598367349     
   1.18535903424161        1.72059134019982     
 Percentage increase in welfare constant r over variable r
  4.143532884116004E-005  -12.6647041575058     
 by state:
           1  1.289658939991832E-003  -13.4116853513324     
           2  6.545040874063674E-004  -13.1095295559546     
           3 -3.805747361102420E-005  -12.7043838636369     
           4 -5.851724627962455E-004  -12.2238708690391     
           5 -1.151921519544461E-003  -11.7398098645152     
 by state CE: 
           1
           2
           3
           4
           5
 CE state:           1   1.01360002861023     
 CE young state:           1   1.00960002861023     
 CE middle state:           1   1.01540002861023     
 CE old state:           1   1.00340002861023     
 CE low income state:           1   1.00740002861023     
 CE middle income state:           1   1.01700002861023     
 CE high income state:           1   1.00860002861023     
 CE state:           2   1.00700002861023     
 CE young state:           2   1.00600002861023     
 CE middle state:           2   1.00740002861023     
 CE old state:           2   1.00000002861023     
 CE low income state:           2   1.00420002861023     
 CE middle income state:           2   1.00840002861023     
 CE high income state:           2   1.00500002861023     
 CE state:           3  0.999600028610229     
 CE young state:           3  0.999600028610229     
 CE middle state:           3  0.999600028610229     
 CE old state:           3  0.999800028610230     
 CE low income state:           3  0.999800028610230     
 CE middle income state:           3  0.999400028610229     
 CE high income state:           3  0.999800028610230     
 CE state:           4  0.993600028610229     
 CE young state:           4  0.996000028610230     
 CE middle state:           4  0.992400028610229     
 CE old state:           4   1.00140002861023     
 CE low income state:           4  0.995800028610230     
 CE middle income state:           4  0.992400028610229     
 CE high income state:           4  0.996600028610229     
 CE state:           5  0.987400028610229     
 CE young state:           5  0.989800028610230     
 CE middle state:           5  0.986000028610230     
 CE old state:           5   1.00440002861023     
 CE low income state:           5  0.989400028610229     
 CE middle income state:           5  0.985400028610229     
 CE high income state:           5  0.995800028610230     
 CE overall   1.00040002861023     
 CE overall young   1.00060002861023     
 CE overall middle   1.00040002861023     
 CE overall old   1.00100002861023     
tabbiasov$ ifort -c -O3 -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 -qopenmp nrtype.f90 nr.f90 nrutil.f90 locate.f90 tridag.f90
tabbiasov$ ifort -c -O3 -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 -qopenmp code.f90
tabbiasov$ ifort -O3 -qopenmp -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 nrtype.o nr.o nrutil.o locate.o tridag.o code.o 
tabbiasov$ ./a.out
 -0.112068014576607       0.112068014576607     
 numiter   1.00000000000000     
  0.879299998283386       7.366000115871429E-002  0.916100025177002     
   4.13000011444092     
  0.947000026702881       2.801700364415172E-002  1.799999922513962E-002
 check2           1  0.890394568443298     
 check2           1  0.999992847442627     
 check2           1   1.00000000000000     
 check2           1   1.00000000000000     
 check2           1   1.00000000000000     
 check2           2  4.258104786276817E-002
 check2           2  0.917964816093445     
 check2           2  0.999996662139893     
 check2           2   1.00000000000000     
 check2           2   1.00000000000000     
 check2           3  1.509662865828432E-006
 check2           3  5.979458987712860E-002
 check2           3  0.940205395221710     
 check2           3  0.999998509883881     
 check2           3   1.00000000000000     
 check2           4  1.293054239257050E-014
 check2           4  3.326285195726086E-006
 check2           4  8.203521370887756E-002
 check2           4  0.957418978214264     
 check2           4   1.00000000000000     
 check2           5  2.152789392545288E-026
 check2           5  4.578574254758203E-014
 check2           5  7.139619356166804E-006
 check2           5  0.109605409204960     
 check2           5   1.00000000000000     
 income
   764.026644829751        798.955395308206        835.915211818513     
   875.025392627003        916.412404366190     
  2.953375000000000E-002
          60
          59
          58
          57
          56
          55
          54
          53
          52
          51
          50
          49
          48
          47
          46
          45
          44
          43
          42
          41
          40
          39
          38
          37
          36
          35
          34
          33
          32
          31
          30
          29
          28
          27
          26
          25
          24
          23
          22
          21
          20
          19
          18
          17
          16
          15
          14
          13
          12
          11
          10
           9
           8
           7
           6
           5
           4
           3
           2
           1
 one
   10000000000.0000        7.10267826414369        6.09008873024984     
 two
   9.17893430086605        8.59150716273854        6.45258098334631     
 three
   10000000000.0000        7.28457521789703        6.18567012714572     
 four
   9.19557784266675        8.72486933295231        6.57180871097090     
   586.139341000000     
          50          36          13           5
      117000
 cumprobs:
  1.509662865828432E-006
  5.979458987712860E-002
  0.940205395221710     
  0.999998509883881     
   1.00000000000000     
  1.490116119384766E-006
  5.979311466217041E-002
  0.880410805344582     
  5.979308021426277E-002
 Ex ante welfare  -16.6678761827737     
 Ex ante welfare by state
  -17.9765789431048       -120083.547339940        6680.00000000000     
  -17.3347049045106       -418979.817542020        24170.0000000000     
  -16.6542953935786       -637842.859278668        38299.0000000000     
  -16.0018866651097       -386765.600695700        24170.0000000000     
  -15.4341855142107       -103115.793420442        6681.00000000000     
 start
 frac increase balance with fixed rate  1.292600000000000E-002
 end
 welfare overall:  -11.9132734773973     
 housing stock   1.57299274029472     
 rental stock  0.291324626581475     
 total residential investment  5.990901488339292E-002
 total non dur consumption  0.909047434498870     
 H/(H+W)  0.208651188006173        1.04325592448456       0.568654328499944     
 wealth over income   1.24071627756281     
 liquid wealth net of debt over income -5.366832960878761E-002
 liquid wealth net of debt over income: working age -0.313416062209080     
 liquid wealth net of debt over income: retired   1.13681028276553     
 C / I_d   15.1738004082198     
 fracown  0.733744109204203     
  0.916100025177002       7.366000115871429E-002  0.879299998283386     
   4.13000011444092     
 diff  1.174283241430436E-002  3.778407058422565E-003  4.671973484420739E-003
  1.327122936533744E-004  1.174283241430436E-002
 ex post welfare by state:
  -13.4625269518860        305283.000000000     
  -13.1322304598569        848599.000000000     
  -12.6991955974551        1199543.00000000     
  -12.1946555561872        841514.000000000     
  -11.6889794226552        305061.000000000     
 ex post welfare weighted by states:
  -12.6614098752510     
 consumption by states:
  0.980103765025257        1.40043122216032     
   1.01388305651709        1.42621683047914     
   1.05978166719790        1.49834905924791     
   1.11857132842295        1.60231969276773     
   1.18762635425694        1.73357678594324     
 solving with variable r
 extra phis  8.918694458090012E-003  1.782848357782374E-002
 new phis
  8.918694458090012E-003  1.782848357782374E-002  0.540962765872877     
   588.710079625000     
          60
          59
          58
          57
          56
          55
          54
          53
          52
          51
          50
          49
          48
          47
          46
          45
          44
          43
          42
          41
          40
          39
          38
          37
          36
          35
          34
          33
          32
          31
          30
          29
          28
          27
          26
          25
          24
          23
          22
          21
          20
          19
          18
          17
          16
          15
          14
          13
          12
          11
          10
           9
           8
           7
           6
           5
           4
           3
           2
           1
 one
   10000000000.0000        7.10587247460904        6.09154892355664     
 two
   9.19374578485656        8.60247833811480        6.45447959053707     
 three
   10000000000.0000        7.28797176520240        6.18703385869837     
 four
   9.21040595391233        8.73645380925632        6.57371012629413     
   600.289554750000     
 cumprobs:
  1.509662865828432E-006
  5.979458987712860E-002
  0.940205395221710     
  0.999998509883881     
   1.00000000000000     
  1.490116119384766E-006
  5.979311466217041E-002
  0.880410805344582     
  5.979308021426277E-002
 Ex ante welfare  -16.6668735533607     
 Ex ante welfare by state
  -17.9877926157996       -120158.454673541        6680.00000000000     
  -17.3400819516910       -419109.780772371        24170.0000000000     
  -16.6532140339730       -637801.444287130        38299.0000000000     
  -15.9944893608837       -386586.807852559        24170.0000000000     
  -15.4214739933121       -103030.867749318        6681.00000000000     
 start
 frac increase balance with fixed rate  1.571828571428572E-002
 end
 welfare overall:  -11.9145552499475     
 housing stock   1.57325119983416     
 rental stock  0.292149389803289     
 total residential investment  5.995277783317046E-002
 total non dur consumption  0.908902580580369     
 H/(H+W)  0.208967858727666        1.04483927806886       0.569124431625318     
 wealth over income   1.23941334486324     
 liquid wealth net of debt over income -5.557439961252612E-002
 liquid wealth net of debt over income: working age -0.316990136260830     
 liquid wealth net of debt over income: retired   1.14258789394691     
 C / I_d   15.1603080528540     
 fracown  0.731908431827978     
  0.916100025177002       7.366000115871429E-002  0.879299998283386     
   4.13000011444092     
 diff  1.055957524621658E-002  3.476731935660106E-003  1.006112448173170E-002
  1.130075093008972E-004  1.055957524621658E-002
 ex post welfare by state:
  -13.4831959650920        305283.000000000     
  -13.1414338884091        848599.000000000     
  -12.6985582888711        1199543.00000000     
  -12.1844753530333        841514.000000000     
  -11.6706128829440        305061.000000000     
 ex post welfare weighted by states:
  -12.6611772298585     
 consumption by states:
  0.978035625363579        1.32139918527881     
   1.01293715961785        1.39484959778184     
   1.05983862898361        1.50197542854351     
   1.12005686500051        1.64454878919406     
   1.19047779814495        1.81174283855537     
 Percentage increase in welfare constant r over variable r
 -1.837436705833404E-005  -12.6614098752510     
 by state:
           1  1.535299671441521E-003  -13.4625269518860     
           2  7.008275235790514E-004  -13.1322304598569     
           3 -5.018495692058478E-005  -12.6991955974551     
           4 -8.348085853653087E-004  -12.1946555561872     
           5 -1.571269744521965E-003  -11.6889794226552     
 by state CE: 
           1
           2
           3
           4
           5
 CE state:           1   1.01620002861023     
 CE young state:           1   1.01140002861023     
 CE middle state:           1   1.01860002861023     
 CE old state:           1   1.00560002861023     
 CE low income state:           1   1.00960002861023     
 CE middle income state:           1   1.01940002861023     
 CE high income state:           1   1.01340002861023     
 CE state:           2   1.00740002861023     
 CE young state:           2   1.00580002861023     
 CE middle state:           2   1.00840002861023     
 CE old state:           2   1.00340002861023     
 CE low income state:           2   1.00480002861023     
 CE middle income state:           2   1.00880002861023     
 CE high income state:           2   1.00620002861023     
 CE state:           3  0.999400028610229     
 CE young state:           3  0.999400028610229     
 CE middle state:           3  0.999600028610229     
 CE old state:           3   1.00120002861023     
 CE low income state:           3  0.999800028610230     
 CE middle income state:           3  0.999200028610229     
 CE high income state:           3   1.00020002861023     
 CE state:           4  0.991000028610230     
 CE young state:           4  0.991600028610229     
 CE middle state:           4  0.990800028610230     
 CE old state:           4   1.00260002861023     
 CE low income state:           4  0.992600028610229     
 CE middle income state:           4  0.989800028610230     
 CE high income state:           4  0.994400028610229     
 CE state:           5  0.982800028610230     
 CE young state:           5  0.984200028610229     
 CE middle state:           5  0.982000028610230     
 CE old state:           5   1.00580002861023     
 CE low income state:           5  0.984600028610229     
 CE middle income state:           5  0.981200028610229     
 CE high income state:           5  0.990400028610229     
 CE overall  0.999800028610230     
 CE overall young  0.999200028610229     
 CE overall middle   1.00020002861023     
 CE overall old   1.00280002861023     
tabbiasov$ ifort -c -O3 -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 -qopenmp nrtype.f90 nr.f90 nrutil.f90 locate.f90 tridag.f90
tabbiasov$ ifort -c -O3 -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 -qopenmp code.f90
tabbiasov$ ifort -O3 -qopenmp -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 nrtype.o nr.o nrutil.o locate.o tridag.o code.o 
tabbiasov$ ./a.out
 -0.112068014576607       0.112068014576607     
 numiter   1.00000000000000     
  0.879299998283386       7.366000115871429E-002  0.916100025177002     
   4.13000011444092     
  0.947000026702881       2.801700364415172E-002  1.799999922513962E-002
 check2           1  0.890394568443298     
 check2           1  0.999992847442627     
 check2           1   1.00000000000000     
 check2           1   1.00000000000000     
 check2           1   1.00000000000000     
 check2           2  4.258104786276817E-002
 check2           2  0.917964816093445     
 check2           2  0.999996662139893     
 check2           2   1.00000000000000     
 check2           2   1.00000000000000     
 check2           3  1.509662865828432E-006
 check2           3  5.979458987712860E-002
 check2           3  0.940205395221710     
 check2           3  0.999998509883881     
 check2           3   1.00000000000000     
 check2           4  1.293054239257050E-014
 check2           4  3.326285195726086E-006
 check2           4  8.203521370887756E-002
 check2           4  0.957418978214264     
 check2           4   1.00000000000000     
 check2           5  2.152789392545288E-026
 check2           5  4.578574254758203E-014
 check2           5  7.139619356166804E-006
 check2           5  0.109605409204960     
 check2           5   1.00000000000000     
 income
   764.026644829751        798.955395308206        835.915211818513     
   875.025392627003        916.412404366190     
  2.614162500000000E-002
          60
          59
          58
          57
          56
          55
          54
          53
          52
          51
          50
          49
          48
          47
          46
          45
          44
          43
          42
          41
          40
          39
          38
          37
          36
          35
          34
          33
          32
          31
          30
          29
          28
          27
          26
          25
          24
          23
          22
          21
          20
          19
          18
          17
          16
          15
          14
          13
          12
          11
          10
           9
           8
           7
           6
           5
           4
           3
           2
           1
 one
   10000000000.0000        7.10267826414369        6.09008873024984     
 two
   9.17893430086605        8.59150716273854        6.45258098334631     
 three
   10000000000.0000        7.28457521789703        6.18567012714572     
 four
   9.19557784266675        8.72486933295231        6.57180871097090     
   582.640875500000     
          50          36          13           5
      117000
 cumprobs:
  1.509662865828432E-006
  5.979458987712860E-002
  0.940205395221710     
  0.999998509883881     
   1.00000000000000     
  1.490116119384766E-006
  5.979311466217041E-002
  0.880410805344582     
  5.979308021426277E-002
 Ex ante welfare  -16.6678761827737     
 Ex ante welfare by state
  -17.9765789431048       -120083.547339940        6680.00000000000     
  -17.3347049045106       -418979.817542020        24170.0000000000     
  -16.6542953935786       -637842.859278668        38299.0000000000     
  -16.0018866651097       -386765.600695700        24170.0000000000     
  -15.4341855142107       -103115.793420442        6681.00000000000     
 start
 frac increase balance with fixed rate  1.292600000000000E-002
 end
 welfare overall:  -11.9132734773973     
 housing stock   1.57299274029472     
 rental stock  0.291324626581475     
 total residential investment  5.990901488339292E-002
 total non dur consumption  0.909047434498870     
 H/(H+W)  0.208651188006173        1.04325592448456       0.568654328499944     
 wealth over income   1.24071627756281     
 liquid wealth net of debt over income -5.366832960878761E-002
 liquid wealth net of debt over income: working age -0.313416062209080     
 liquid wealth net of debt over income: retired   1.13681028276553     
 C / I_d   15.1738004082198     
 fracown  0.733744109204203     
  0.916100025177002       7.366000115871429E-002  0.879299998283386     
   4.13000011444092     
 diff  1.174283241430436E-002  3.778407058422565E-003  4.671973484420739E-003
  1.327122936533744E-004  1.174283241430436E-002
 ex post welfare by state:
  -13.4625269518860        305283.000000000     
  -13.1322304598569        848599.000000000     
  -12.6991955974551        1199543.00000000     
  -12.1946555561872        841514.000000000     
  -11.6889794226552        305061.000000000     
 ex post welfare weighted by states:
  -12.6614098752510     
 consumption by states:
  0.980103765025257        1.40043122216032     
   1.01388305651709        1.42621683047914     
   1.05978166719790        1.49834905924791     
   1.11857132842295        1.60231969276773     
   1.18762635425694        1.73357678594324     
 solving with variable r
 extra phis  8.923152540004661E-008  8.923152540004661E-008
 new phis
  8.923152540004661E-008  8.923152540004661E-008  0.540962765872877     
   584.746759750000     
          60
          59
          58
          57
          56
          55
          54
          53
          52
          51
          50
          49
          48
          47
          46
          45
          44
          43
          42
          41
          40
          39
          38
          37
          36
          35
          34
          33
          32
          31
          30
          29
          28
          27
          26
          25
          24
          23
          22
          21
          20
          19
          18
          17
          16
          15
          14
          13
          12
          11
          10
           9
           8
           7
           6
           5
           4
           3
           2
           1
 one
   10000000000.0000        7.10416446255561        6.09054520782580     
 two
   9.19039559997064        8.59960319671150        6.45330178978775     
 three
   10000000000.0000        7.28648165258389        6.18619179863323     
 four
   9.20706910994982        8.73370670004647        6.57265342806883     
   589.052863000000     
 cumprobs:
  1.509662865828432E-006
  5.979458987712860E-002
  0.940205395221710     
  0.999998509883881     
   1.00000000000000     
  1.490116119384766E-006
  5.979311466217041E-002
  0.880410805344582     
  5.979308021426277E-002
 Ex ante welfare  -16.6672512596045     
 Ex ante welfare by state
  -17.9795540384094       -120103.420976575        6680.00000000000     
  -17.3361865344804       -419015.628538391        24170.0000000000     
  -16.6537791303584       -637823.086913595        38299.0000000000     
  -15.9991418801844       -386699.259244057        24170.0000000000     
  -15.4293863626014       -103083.730288540        6681.00000000000     
 start
 frac increase balance with fixed rate  1.574457142857143E-002
 end
 welfare overall:  -11.9139349620537     
 housing stock   1.57470959145701     
 rental stock  0.290857395639159     
 total residential investment  5.994012111334152E-002
 total non dur consumption  0.908950382936610     
 H/(H+W)  0.209063812266596        1.04531904575543       0.569266748267082     
 wealth over income   1.23993618202095     
 liquid wealth net of debt over income -5.619272456682933E-002
 liquid wealth net of debt over income: working age -0.317618291573878     
 liquid wealth net of debt over income: retired   1.14197575696275     
 C / I_d   15.1643067456182     
 fracown  0.732815560832319     
  0.916100025177002       7.366000115871429E-002  0.879299998283386     
   4.13000011444092     
 diff  1.214516011062603E-002  3.624335438576057E-003  1.214516011062603E-002
  1.186841359487390E-004  1.068141056531242E-002
 ex post welfare by state:
  -13.4770740616211        305283.000000000     
  -13.1382401865538        848599.000000000     
  -12.6980752013601        1199543.00000000     
  -12.1863046352589        841514.000000000     
  -11.6750320168683        305061.000000000     
 ex post welfare weighted by states:
  -12.6605283448633     
 consumption by states:
  0.978756638556503        1.31921524926336     
   1.01334253529183        1.39429964191129     
   1.05990782144453        1.50316722604160     
   1.11979226826740        1.64871392267049     
   1.18979797419485        1.81519236463883     
 Percentage increase in welfare constant r over variable r
 -6.962339869341890E-005  -12.6614098752510     
 by state:
           1  1.080563090948176E-003  -13.4625269518860     
           2  4.576318330159785E-004  -13.1322304598569     
           3 -8.822575307334982E-005  -12.6991955974551     
           4 -6.848017059394434E-004  -12.1946555561872     
           5 -1.193209884505675E-003  -11.6889794226552     
 by state CE: 
           1
           2
           3
           4
           5
 CE state:           1   1.01140002861023     
 CE young state:           1   1.00700002861023     
 CE middle state:           1   1.01340002861023     
 CE old state:           1   1.00360002861023     
 CE low income state:           1   1.00580002861023     
 CE middle income state:           1   1.01440002861023     
 CE high income state:           1   1.00660002861023     
 CE state:           2   1.00480002861023     
 CE young state:           2   1.00360002861023     
 CE middle state:           2   1.00560002861023     
 CE old state:           2   1.00220002861023     
 CE low income state:           2   1.00280002861023     
 CE middle income state:           2   1.00600002861023     
 CE high income state:           2   1.00220002861023     
 CE state:           3  0.999000028610230     
 CE young state:           3  0.999200028610229     
 CE middle state:           3  0.999000028610230     
 CE old state:           3   1.00080002861023     
 CE low income state:           3  0.999600028610229     
 CE middle income state:           3  0.998800028610230     
 CE high income state:           3  0.999600028610229     
 CE state:           4  0.992600028610229     
 CE young state:           4  0.994000028610230     
 CE middle state:           4  0.991800028610230     
 CE old state:           4   1.00300002861023     
 CE low income state:           4  0.994400028610229     
 CE middle income state:           4  0.991400028610229     
 CE high income state:           4  0.997000028610230     
 CE state:           5  0.986800028610230     
 CE young state:           5  0.988800028610230     
 CE middle state:           5  0.985800028610230     
 CE old state:           5   1.00640002861023     
 CE low income state:           5  0.988000028610230     
 CE middle income state:           5  0.985200028610229     
 CE high income state:           5  0.996800028610230     
 CE overall  0.999200028610229     
 CE overall young  0.999000028610230     
 CE overall middle  0.999400028610229     
 CE overall old   1.00260002861023     
tabbiasov$ ifort -c -O3 -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 -qopenmp nrtype.f90 nr.f90 nrutil.f90 locate.f90 tridag.f90
tabbiasov$ ifort -c -O3 -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 -qopenmp code.f90
tabbiasov$ ifort -O3 -qopenmp -Wl,-stack_size,0x40000000,-stack_addr,0xf0000000 nrtype.o nr.o nrutil.o locate.o tridag.o code.o 
tabbiasov$ ./a.out
 -0.112068014576607       0.112068014576607     
 numiter   1.00000000000000     
  0.879299998283386       7.366000115871429E-002  0.916100025177002     
   4.13000011444092     
  0.947000026702881       2.801700364415172E-002  1.799999922513962E-002
 check2           1  0.890394568443298     
 check2           1  0.999992847442627     
 check2           1   1.00000000000000     
 check2           1   1.00000000000000     
 check2           1   1.00000000000000     
 check2           2  4.258104786276817E-002
 check2           2  0.917964816093445     
 check2           2  0.999996662139893     
 check2           2   1.00000000000000     
 check2           2   1.00000000000000     
 check2           3  1.509662865828432E-006
 check2           3  5.979458987712860E-002
 check2           3  0.940205395221710     
 check2           3  0.999998509883881     
 check2           3   1.00000000000000     
 check2           4  1.293054239257050E-014
 check2           4  3.326285195726086E-006
 check2           4  8.203521370887756E-002
 check2           4  0.957418978214264     
 check2           4   1.00000000000000     
 check2           5  2.152789392545288E-026
 check2           5  4.578574254758203E-014
 check2           5  7.139619356166804E-006
 check2           5  0.109605409204960     
 check2           5   1.00000000000000     
 income
   764.026644829751        798.955395308206        835.915211818513     
   875.025392627003        916.412404366190     
  2.491387500000000E-002
          60
          59
          58
          57
          56
          55
          54
          53
          52
          51
          50
          49
          48
          47
          46
          45
          44
          43
          42
          41
          40
          39
          38
          37
          36
          35
          34
          33
          32
          31
          30
          29
          28
          27
          26
          25
          24
          23
          22
          21
          20
          19
          18
          17
          16
          15
          14
          13
          12
          11
          10
           9
           8
           7
           6
           5
           4
           3
           2
           1
 one
   10000000000.0000        7.11555740313814        6.10148740618847     
 two
   9.19819875787089        8.60781359727256        6.46518813335826     
 three
   10000000000.0000        7.30094817200435        6.19911670366598     
 four
   9.21516166899675        8.74397973264210        6.58634061558424     
   582.806561500000     
          50          36          13           5
      117000
 cumprobs:
  1.509662865828432E-006
  5.979458987712860E-002
  0.940205395221710     
  0.999998509883881     
   1.00000000000000     
  1.490116119384766E-006
  5.979311466217041E-002
  0.880410805344582     
  5.979308021426277E-002
 Ex ante welfare  -16.6753366055008     
 Ex ante welfare by state
  -18.0178099139478       -120358.970225171        6680.00000000000     
  -17.3587033931905       -419559.861013415        24170.0000000000     
  -16.6611156035673       -638104.066501024        38299.0000000000     
  -15.9929986785876       -386550.778061463        24170.0000000000     
  -15.4108643540210       -102959.984749215        6681.00000000000     
 start
 frac increase balance with fixed rate  1.297457142857143E-002
 end
 welfare overall:  -11.9073835787868     
 housing stock   1.58352205322117     
 rental stock  0.283689990535612     
 total residential investment  5.989156604040709E-002
 total non dur consumption  0.909706778358977     
 H/(H+W)  0.208985571142741        1.04492784014238       0.569150706852753     
 wealth over income   1.24614933108186     
 liquid wealth net of debt over income -5.598679794026971E-002
 liquid wealth net of debt over income: working age -0.312580924687701     
 liquid wealth net of debt over income: retired   1.12003817404208     
 C / I_d   15.1892301119821     
 fracown  0.741062956782105     
  0.916100025177002       7.366000115871429E-002  0.879299998283386     
   4.13000011444092     
 diff  1.561541355344729E-002  5.097101732475811E-003  1.143451724859344E-002
  1.571620858917194E-004  1.561541355344729E-002
 ex post welfare by state:
  -13.4864441496730        305283.000000000     
  -13.1426375861736        848599.000000000     
  -12.6970515668057        1199543.00000000     
  -12.1800828287448        841514.000000000     
  -11.6627035086335        305061.000000000     
 ex post welfare weighted by states:
  -12.6594905104372     
 consumption by states:
  0.979067034191469        1.36999085539660     
   1.01345572477359        1.41576236751047     
   1.06030881690177        1.49727695755437     
   1.12006721427816        1.62134888174846     
   1.18999301359894        1.78449735350259     
 solving with variable r
 extra phis  8.923152540004661E-008  8.923152540004661E-008
 new phis
  8.923152540004661E-008  8.923152540004661E-008  0.540962765872877     
   584.895806625000     
          60
          59
          58
          57
          56
          55
          54
          53
          52
          51
          50
          49
          48
          47
          46
          45
          44
          43
          42
          41
          40
          39
          38
          37
          36
          35
          34
          33
          32
          31
          30
          29
          28
          27
          26
          25
          24
          23
          22
          21
          20
          19
          18
          17
          16
          15
          14
          13
          12
          11
          10
           9
           8
           7
           6
           5
           4
           3
           2
           1
 one
   10000000000.0000        7.11699199416439        6.10193043180942     
 two
   9.20947817923409        8.61580999045566        6.46589052488907     
 three
   10000000000.0000        7.30280170823883        6.19962197510573     
 four
   9.22649366375486        8.75278110577992        6.58716131965172     
   590.049577375000     
 cumprobs:
  1.509662865828432E-006
  5.979458987712860E-002
  0.940205395221710     
  0.999998509883881     
   1.00000000000000     
  1.490116119384766E-006
  5.979311466217041E-002
  0.880410805344582     
  5.979308021426277E-002
 Ex ante welfare  -16.6746937732654     
 Ex ante welfare by state
  -18.0207486460936       -120378.600955905        6680.00000000000     
  -17.3601928143605       -419595.860323093        24170.0000000000     
  -16.6606027001180       -638084.422811820        38299.0000000000     
  -15.9902180296252       -386483.569776040        24170.0000000000     
  -15.4059157999307       -102926.923459337        6681.00000000000     
 start
 frac increase balance with fixed rate  1.579914285714286E-002
 end
 welfare overall:  -11.9070469377117     
 housing stock   1.58790472796304     
 rental stock  0.280692510025331     
 total residential investment  5.989217627516367E-002
 total non dur consumption  0.909761475207830     
 H/(H+W)  0.209624740883576        1.04812368879781       0.570097518950084     
 wealth over income   1.24580684546590     
 liquid wealth net of debt over income -5.995282093425133E-002
 liquid wealth net of debt over income: working age -0.317481871537677     
 liquid wealth net of debt over income: retired   1.12035710454050     
 C / I_d   15.1899886059208     
 fracown  0.742486029499354     
  0.916100025177002       7.366000115871429E-002  0.879299998283386     
   4.13000011444092     
 diff  2.755961021489735E-002  5.374716919518009E-003  2.755961021489735E-002
  1.584165940131958E-004  1.553548035461152E-002
 ex post welfare by state:
  -13.5006609845837        305283.000000000     
  -13.1486320434088        848599.000000000     
  -12.6952873908360        1199543.00000000     
  -12.1708130073413        841514.000000000     
  -11.6486196442021        305061.000000000     
 ex post welfare weighted by states:
  -12.6581230022190     
 consumption by states:
  0.977700625890534        1.28882282800322     
   1.01292269327544        1.38131828808869     
   1.06055688515193        1.50378638956863     
   1.12119476133902        1.67710671874925     
   1.19212504164560        1.86391561105028     
 Percentage increase in welfare constant r over variable r
 -1.080223739720679E-004  -12.6594905104372     
 by state:
           1  1.054157400786227E-003  -13.4864441496730     
           2  4.561076264861003E-004  -13.1426375861736     
           3 -1.389437508779231E-004  -12.6970515668057     
           4 -7.610639052118368E-004  -12.1800828287448     
           5 -1.207598600182887E-003  -11.6627035086335     
 by state CE: 
           1
           2
           3
           4
           5
 CE state:           1   1.01100002861023     
 CE young state:           1   1.00700002861023     
 CE middle state:           1   1.01300002861023     
 CE old state:           1   1.00520002861023     
 CE low income state:           1   1.00540002861023     
 CE middle income state:           1   1.01420002861023     
 CE high income state:           1   1.00660002861023     
 CE state:           2   1.00480002861023     
 CE young state:           2   1.00340002861023     
 CE middle state:           2   1.00560002861023     
 CE old state:           2   1.00240002861023     
 CE low income state:           2   1.00260002861023     
 CE middle income state:           2   1.00600002861023     
 CE high income state:           2   1.00280002861023     
 CE state:           3  0.998600028610229     
 CE young state:           3  0.998400028610229     
 CE middle state:           3  0.998600028610229     
 CE old state:           3   1.00020002861023     
 CE low income state:           3  0.999200028610229     
 CE middle income state:           3  0.998200028610229     
 CE high income state:           3  0.999200028610229     
 CE state:           4  0.991800028610230     
 CE young state:           4  0.991400028610229     
 CE middle state:           4  0.992000028610230     
 CE old state:           4  0.999800028610230     
 CE low income state:           4  0.994000028610230     
 CE middle income state:           4  0.990400028610229     
 CE high income state:           4  0.996200028610229     
 CE state:           5  0.986600028610229     
 CE young state:           5  0.987400028610229     
 CE middle state:           5  0.986400028610229     
 CE old state:           5   1.00060002861023     
 CE low income state:           5  0.988800028610230     
 CE middle income state:           5  0.984800028610230     
 CE high income state:           5  0.996400028610229     
 CE overall  0.998800028610230     
 CE overall young  0.998000028610230     
 CE overall middle  0.999200028610229     
 CE overall old   1.00120002861023  